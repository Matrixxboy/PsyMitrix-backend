<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mental Health Report</title>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- html2pdf -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
  body {
    font-family: 'Helvetica', Arial, sans-serif;
    background-color: #f9f9f9;
    color: #333;
    margin: 0;
  }

  #downloadBtn {
    display: block;
    margin: 20px auto;
    padding: 12px 25px;
    font-size: 16px;
    cursor: pointer;
    border: none;
    border-radius: 8px;
    background: linear-gradient(90deg, #6a11cb, #2575fc);
    color: #fff;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  }

  #report {
    width: 794px; /* A4 width in px */
    margin: 0 auto;
    background: #fff;
    padding: 40px;
    box-sizing: border-box;
  }

  .pdf-page {
    page-break-after: always;
    position: relative;
    padding: 40px;
    box-sizing: border-box;
  }

  h1 {
    text-align: center;
    font-size: 32px;
    margin-bottom: 5px;
  }

  h2 {
    color: #2c3e50;
    font-size: 24px;
    border-bottom: 2px solid #d1d1d1;
    padding-bottom: 6px;
    margin-bottom: 15px;
  }

  .section-card {
    background: #f2f6ff;
    border-left: 5px solid #6a11cb;
    padding: 12px 18px;
    margin-bottom: 12px;
    border-radius: 6px;
  }

  .section-card h3 {
    margin: 0 0 5px 0;
    color: #2575fc;
  }

  canvas {
    max-width: 100%;
    margin-top: 15px;
    background: #fff;
    padding: 10px;
    border-radius: 12px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  }

  footer {
    position: absolute;
    bottom: 15px;
    left: 40px;
    right: 40px;
    font-size: 12px;
    color: #555;
    display: flex;
    justify-content: space-between;
  }

</style>
</head>
<body>

<button id="downloadBtn">Download PDF</button>

<div id="report">
  <!-- Cover Page -->
  <div class="pdf-page">
    <h1>Utsav's Mental Health Report</h1>
    <p style="text-align:center; color:#555; font-size:16px;">Generated by PsyMitrix</p>
    <footer>
      <span>www.psymitrix.com</span>
      <span>Page 1</span>
    </footer>
  </div>

  <!-- Sections -->
  <div class="pdf-page" id="sections">
    <h2>Report Overview</h2>
  </div>

  <!-- Comparison Chart -->
  <div class="pdf-page">
    <h2>Comparison of Traits</h2>
    <canvas id="comparisonChart" height="200"></canvas>
    <footer>
      <span>www.psymitrix.com</span>
      <span>Page 3</span>
    </footer>
  </div>

  <!-- Radar Chart -->
  <div class="pdf-page">
    <h2>Radar Chart of Traits</h2>
    <canvas id="radarChart" height="200"></canvas>
    <footer>
      <span>www.psymitrix.com</span>
      <span>Page 4</span>
    </footer>
  </div>

  <!-- Career Fit -->
  <div class="pdf-page">
    <h2>Career Fit Recommendations</h2>
    <canvas id="careerChart" height="200"></canvas>
    <footer>
      <span>www.psymitrix.com</span>
      <span>Page 5</span>
    </footer>
  </div>
</div>

<script>
const reportData = {
  "sections": [
    {"title":"Openness","text":"Utsav demonstrates high cognitive curiosity, exploring new ideas."},
    {"title":"Individualization","text":"Self-direction is evident in Utsav’s goal-oriented approach."},
    {"title":"Introversion–Extraversion","text":"He tends toward an introverted orientation."},
    {"title":"Self‑Esteem","text":"Utsav maintains a stable sense of self-worth."},
    {"title":"Enneagram & DISC Summary","text":"Enneagram type 3 profile indicates goal-driven ambition."},
    {"title":"FIRO‑B Summary","text":"His interpersonal needs reveal a moderate demand for inclusion."},
    {"title":"Career Fit","text":"Fields that leverage analytical thinking and creative output."},
    {"title":"Neuro Map","text":"Openness – dorsolateral prefrontal cortex; Individualization – ventromedial prefrontal cortex."}
  ],
  "charts_data": {
    "comparison_tables":[{"trait":"Openness","Utsav":4.5,"average":3.0},{"trait":"Individualization","Utsav":4.2,"average":3.1}],
    "radar_chart":[{"trait":"Openness","score":4.5},{"trait":"Individualization","score":4.2},{"trait":"Introversion","score":3.8},{"trait":"Self‑Esteem","score":4.0}],
    "bar_chart":[{"career":"Software Development","fit":92},{"career":"Data Analytics","fit":88},{"career":"Product Design","fit":85},{"career":"Consulting","fit":80}]
  }
};

const p_name = "Utsav";

// Populate sections as cards
const sectionsDiv = document.getElementById("sections");
reportData.sections.forEach((sec, idx) => {
  const div = document.createElement("div");
  div.className = "section-card";
  div.innerHTML = `<h3>${sec.title}</h3><p>${sec.text}</p>`;
  sectionsDiv.appendChild(div);
});
sectionsDiv.innerHTML += `<footer><span>www.psymitrix.com</span><span>Page 2</span></footer>`;

// Comparison Chart
new Chart(document.getElementById('comparisonChart').getContext('2d'), {
  type: 'bar',
  data: {
    labels: reportData.charts_data.comparison_tables.map(r => r.trait),
    datasets: [
      { label: p_name, data: reportData.charts_data.comparison_tables.map(r => r[p_name]), backgroundColor: 'rgba(102,126,234,0.7)', borderRadius:5 },
      { label: 'Average', data: reportData.charts_data.comparison_tables.map(r => r.average), backgroundColor: 'rgba(118,75,162,0.7)', borderRadius:5 }
    ]
  },
  options: { responsive:true, plugins:{legend:{position:'top'}}, scales:{y:{beginAtZero:true,max:5}} }
});

// Radar Chart
new Chart(document.getElementById('radarChart').getContext('2d'), {
  type: 'radar',
  data: {
    labels: reportData.charts_data.radar_chart.map(r => r.trait),
    datasets:[{
      label: p_name,
      data: reportData.charts_data.radar_chart.map(r => r.score),
      backgroundColor:'rgba(102,126,234,0.3)',
      borderColor:'rgba(102,126,234,1)',
      borderWidth:2,
      pointBackgroundColor:'rgba(102,126,234,1)'
    }]
  },
  options:{responsive:true, scales:{r:{beginAtZero:true,max:5}}}
});

// Career Fit Chart
new Chart(document.getElementById('careerChart').getContext('2d'), {
  type: 'bar',
  data:{
    labels: reportData.charts_data.bar_chart.map(r=>r.career),
    datasets:[{
      label:'Fit (%)',
      data: reportData.charts_data.bar_chart.map(r=>r.fit),
      backgroundColor:['rgba(102,126,234,0.7)','rgba(118,75,162,0.7)','rgba(255,159,64,0.7)','rgba(75,192,192,0.7)'],
      borderRadius:6
    }]
  },
  options:{responsive:true, plugins:{legend:{display:false}}, scales:{y:{beginAtZero:true,max:100}}}
});

// Download PDF
document.getElementById("downloadBtn").addEventListener("click",()=>{
  html2pdf().set({filename:`${p_name}_Mental_Health_Report.pdf`, html2canvas:{scale:2}}).from(document.getElementById("report")).save();
});
</script>

</body>
</html>
